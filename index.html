<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice 4.1.13  (Win32)">
	<META NAME="CREATED" CONTENT="20220930;21312419">
	<META NAME="CHANGED" CONTENT="20220930;21390545">
	<STYLE TYPE="text/css">
	<!--
		@page { size: 8.5in 11in; margin: 0.79in }
		P { margin-bottom: 0.08in }
		P.western { so-language: en-US }
		H1 { margin-bottom: 0.08in }
		H1.western { font-family: "Times New Roman", serif; so-language: en-US }
		H1.cjk { font-family: "SimSun" }
		H1.ctl { font-family: "Arial" }
		PRE.western { so-language: en-US }
		PRE.cjk { font-family: "NSimSun", monospace }
		H2 { margin-bottom: 0.08in }
		H2.western { so-language: en-US }
		H2.cjk { font-family: "SimSun" }
		H2.ctl { font-family: "Arial" }
		H3 { margin-bottom: 0.08in }
		H3.western { so-language: en-US }
		H3.cjk { font-family: "SimSun" }
		H3.ctl { font-family: "Arial" }
		A:link { so-language: zxx }
		CODE.cjk { font-family: "NSimSun", monospace }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1 CLASS="western" STYLE="font-style: normal; font-weight: normal"><A NAME="ctl00_ArticleTitle"></A>
<FONT COLOR="#333333"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=6 STYLE="font-size: 28pt"><SPAN STYLE="text-decoration: none">Android:
Fast Communication with .NET Using Protocol Buffers</SPAN></FONT></FONT></FONT></H1>
<DIV ID="ctl00_avatarWrap" DIR="LTR">
	<P CLASS="western" ALIGN=LEFT STYLE="margin-right: 0.1in; margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; widows: 2; orphans: 2; text-decoration: none">
	<BR>
	</P>
</DIV>
<P CLASS="western" STYLE="margin-left: 0.31in; margin-bottom: 0in; border: none; padding: 0in; widows: 2; orphans: 2">
<BR>
</P>
<DIV ID="ctl00_DescriptionSpot" DIR="LTR">
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; widows: 2; orphans: 2">
	<FONT COLOR="#808080">Improve the performance of interprocess
	communication between Android and .NET using fast binary
	serialization (Protocol Buffers) instead of XML or JSON.</FONT></P>
</DIV>
<DIV ID="contentdiv" DIR="LTR">
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; background: transparent; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="https://www.codeproject.com/KB/android/640249/AndroidNetCommunicationProtoBuf.zip"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><B>Download
		source code - 707.8 KB</B></SPAN></FONT></FONT></SPAN></FONT></A></P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Related
	articles:</FONT></FONT></FONT></P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="http://www.codeproject.com/Articles/340714/Android-How-to-communicate-with-NET-application-vi"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Android:
		How to communicate with .NET application via TCP</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="http://www.codeproject.com/Articles/749534/Remote-Procedure-Calls-between-Android-and-NET"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Remote
		Procedure Calls between Android and .NET</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="http://www.codeproject.com/Articles/433513/Android-How-to-Receive-Notification-Messages-from"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Android:
		How to Receive Notification Messages from Multiple .NET
		Applications via Websockets</SPAN></SPAN></FONT></FONT></SPAN></FONT></A></P>
	</UL>
	<H2 CLASS="western" STYLE="margin-top: 0.21in; margin-bottom: 0.11in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=6 STYLE="font-size: 21pt">Introduction</FONT></FONT></FONT></H2>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>One
	of challenges in the interprocess communication when communicating
	across platforms (e.g. between Android and .NET) is how to encode
	(serialize) messages so that they can be understood by both
	platforms. Default binary serializers provided by platforms are not
	compatible and so the common solution is to encode messages into
	some text format e.g. XML or JSON. This can be perfectly ok in many
	cases but for applications with high performance expectations using
	the text format may not be an optimal solution.<BR><BR>The example
	bellow demonstrates how to use Protocol Buffers binary serialization
	in the inter-process communication between Android and .NET
	applications.</FONT></FONT></FONT></P>
	<H3 CLASS="western" STYLE="margin-top: 0in; margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 14pt">You
	Need to Download</FONT></FONT></FONT></H3>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>In
	order to build the example source code you will need to add
	references to related libraries into the project. To get these
	libraries you can download:</FONT></FONT></FONT></P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="https://code.google.com/p/eneter-protobuf-serializer/"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Eneter.ProtoBuf.Serializer</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		protocol buffer serializer for Eneter, it also contains compiled
		protocol buffer libraries and utility applications for 'proto'
		files.</SPAN></SPAN></FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="http://www.eneter.net/ProductDownload.htm"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Eneter.Messaging.Framework</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		communication framework.</SPAN></SPAN></FONT></FONT></FONT></P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Protocol
	Buffers libraries are open source projects that can be found at:</FONT></FONT></FONT></P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="http://code.google.com/p/protobuf/"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">protobuf&nbsp;</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">-
		Google implementation of Protocol Buffers for Java, C++ and Python.</SPAN></SPAN></FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="https://code.google.com/p/protobuf-net/"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">protobuf-net</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		Protocol Buffers implementation from Marc Gravell for .NET
		platforms.</SPAN></SPAN></FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<A HREF="https://code.google.com/p/eneter-protobuf-serializer/"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Eneter.ProtoBuf.Serializer</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		Open source project to integrate Protocol Buffers and Eneter
		Messaging Framework.</SPAN></SPAN></FONT></FONT></FONT></P>
	</UL>
	<H3 CLASS="western" STYLE="margin-top: 0in; margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 14pt">Add
	Following References into your Project</FONT></FONT></FONT></H3>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Into
	.NET project:</FONT></FONT></FONT></P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">protobuf-net.dll</SPAN></SPAN></FONT></FONT></FONT></EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		protocol buffers serializer for .NET, Windows Phone, Silverlight
		and Compact Framework developed by Marc Gravell.</SPAN></SPAN></FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Eneter.ProtoBuf.Serializer.dll</SPAN></SPAN></FONT></FONT></FONT></EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		implements serializer for Eneter Messaging Framework using
		protobuf-net.dll.</SPAN></SPAN></FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Eneter.Messaging.Framework.dll</SPAN></SPAN></FONT></FONT></FONT></EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		lightweight cross-platform framework for inter-process
		communication.</SPAN></SPAN></FONT></FONT></FONT></P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Into
	Android project:</FONT></FONT></FONT></P>
	<UL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">protobuf.jar</SPAN></SPAN></FONT></FONT></FONT></EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		protocol buffers serializer for Java and Android developed by
		Google.</SPAN></SPAN></FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">eneter-protobuf-serializer.jar</SPAN></SPAN></FONT></FONT></FONT></EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		implements serializer for Eneter Messaging Framework using
		protobuf.jar from Google.</SPAN></SPAN></FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">eneter-messaging.jar</SPAN></SPAN></FONT></FONT></FONT></EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
		lightweight cross-platform framework for inter-process
		communication.</SPAN></SPAN></FONT></FONT></FONT></P>
	</UL>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
	<STRONG><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Important:</SPAN></SPAN></FONT></FONT></FONT></STRONG><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;please
	follow this procedure (for Eclipse) to add libraries into the
	Android project:<BR>(To add a library into the project you need to
	import it instead of adding it via project properties.<BR>Also
	ensure Java compliance level is set to 6.0.&nbsp;</SPAN></SPAN></FONT></FONT></FONT><EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Properties
	-&gt; Java Compiler -&gt; JDK Compliance -&gt; 1.6</SPAN></SPAN></FONT></FONT></FONT></EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.)</SPAN></SPAN></FONT></FONT></FONT></P>
	<OL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Create
		a new folder 'libs' in your project. (use exactly name libs)</FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Right
		click on 'libs' and choose&nbsp;</SPAN></SPAN></FONT></FONT></FONT><EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">'Import...'
		-&gt; 'General/File System' -&gt; 'Next'</SPAN></SPAN></FONT></FONT></FONT></EM><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.</SPAN></SPAN></FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Then
		click 'Browser' button for 'From directory' and navigate to
		directory with libraries you want to add.</FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Select
		check boxes for libraries you want to add.</FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Press
		'Finish'</FONT></FONT></FONT></P>
	</OL>
	<H2 CLASS="western" STYLE="margin-top: 0.21in; margin-bottom: 0.11in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=6 STYLE="font-size: 21pt">Protocol
	Buffers</FONT></FONT></FONT></H2>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Protocol
	Buffers is a binary serialization originally developed by Google to
	share data among applications developed in different languages like
	Java, C++ and Python. It became the open source and was ported to
	other languages and platforms too.</FONT></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">The
	biggest advantage of Protocol Buffers is
	its&nbsp;</SPAN></SPAN></FONT></FONT></FONT><STRONG><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">performance</SPAN></SPAN></FONT></FONT></FONT></CODE></STRONG><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;and&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">availability
	on multiple platforms</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;what
	makes it an alternative to consider when designing the communication
	between applications.<BR>If you are interested a simple performance
	measurement is available
	at&nbsp;</SPAN></SPAN></FONT></FONT></FONT><A HREF="https://code.google.com/p/eneter-protobuf-serializer/wiki/PerformanceMeasurements"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Times New Roman"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">https://code.google.com/p/eneter-protobuf-serializer/wiki/PerformanceMeasurements</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#000000"><FONT FACE="Times New Roman"><FONT SIZE=4><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.</SPAN></SPAN></FONT></FONT></FONT></P>
	<H3 CLASS="western" STYLE="margin-top: 0in; margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 14pt">Working
	With Protocol Buffers</FONT></FONT></FONT></H3>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>The
	following procedure is optimized for defining messages for
	cross-platform communication:<BR>(If you want to use Protocol
	Buffers only in .NET you do not have to declare messages via the
	'proto' file but you can declare them directly in the source code by
	attributing classes - same way as using DataContractSerializer.)</FONT></FONT></FONT></P>
	<OL>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Declare
		messages in the 'proto' file.</FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Compile
		the 'proto' file into the source code (C# and Java). It transforms
		declared messages to classes containing specified fields and the
		serialization functionality.</FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Include
		generated source files into C# and Java projects.</FONT></FONT></FONT></P>
		<LI><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
		<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Initialize
		Eneter communication components to use&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">EneterProtoBufSerializer</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.</SPAN></SPAN></FONT></FONT></FONT></P>
	</OL>
	<P CLASS="western" ALIGN=CENTER STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2; text-decoration: none">
	<FONT COLOR="#005782"><A HREF="https://www.codeproject.com/KB/android/640249/UsingProtoBuf.png"><IMG SRC="https://www.codeproject.com/KB/android/640249/UsingProtoBuf-r-700.png" NAME="graphics8" ALT="640249/UsingProtoBuf.png" ALIGN=BOTTOM WIDTH=700 HEIGHT=781 BORDER=0></A></FONT></P>
	<H2 CLASS="western" STYLE="margin-top: 0.21in; margin-bottom: 0.11in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=6 STYLE="font-size: 21pt">Example
	Code</FONT></FONT></FONT></H2>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">The
	example bellow is exactly the same as in my previous
	article&nbsp;</SPAN></SPAN></FONT></FONT></FONT><A HREF="http://www.codeproject.com/Articles/340714/Android-How-to-communicate-with-NET-application-vi"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Android:
	How to communicate with .NET application via TCP</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.
	The only difference is the code in this article
	uses&nbsp;</SPAN></SPAN></FONT></FONT></FONT><STRONG><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">EneterProtoBufSerializer</SPAN></SPAN></FONT></FONT></FONT></STRONG><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;instead
	of&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">XmlStringSerializer</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.</SPAN></SPAN></FONT></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Please
	refer to&nbsp;</SPAN></SPAN></FONT></FONT></FONT><A HREF="http://www.codeproject.com/Articles/340714/Android-How-to-communicate-with-NET-application-vi"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Android:
	How to communicate with .NET application via TCP</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;if
	you need details about how to use TCP on Android and how to setup
	the IP address in the emulator.</SPAN></SPAN></FONT></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2; text-decoration: none">
	<FONT COLOR="#005782"><A HREF="https://www.codeproject.com/KB/android/640249/CommunicationBetweenAndroidandNETProtoBuf.png"><IMG SRC="https://www.codeproject.com/KB/android/640249/CommunicationBetweenAndroidandNETProtoBuf.png" NAME="graphics9" ALT="640249/CommunicationBetweenAndroidandNETProtoBuf.png" ALIGN=BOTTOM WIDTH=600 HEIGHT=318 BORDER=0></A></FONT></P>
	<H3 CLASS="western" STYLE="margin-top: 0in; margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 14pt">proto
	File</FONT></FONT></FONT></H3>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">The
	'proto' file represents a contract describing messages that shall be
	used for the interaction. Messages are declared in the platform
	neutral&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">protocol
	buffer language</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;-
	for the syntax details you can refer
	to&nbsp;</SPAN></SPAN></FONT></FONT></FONT><A HREF="https://developers.google.com/protocol-buffers/docs/proto"><FONT COLOR="#005782"><SPAN STYLE="text-decoration: none"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">https://developers.google.com/protocol-buffers/docs/proto</SPAN></SPAN></FONT></FONT></SPAN></FONT></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.</SPAN></SPAN></FONT></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>Messages
	in our example are declared in the file MessageDeclarations.proto:</FONT></FONT></FONT></P>
	<DIV ID="premain179706" DIR="LTR" STYLE="background: #fbedbb">
		<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; widows: 2; orphans: 2"><A NAME="copycode179706"></A>
		<FONT COLOR="#999999">Java</FONT></P>
	</DIV>
	<PRE CLASS="western" STYLE="background: #fbedbb; border: none; padding: 0in; font-style: normal; font-weight: normal; widows: 2; orphans: 2"><A NAME="pre179706"></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><FONT COLOR="#008000"><I>//</I></FONT><FONT COLOR="#008000"> </FONT><FONT COLOR="#008000"><I>Request Message</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">message MyRequest</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">required string Text = </SPAN></SPAN></FONT></FONT><FONT COLOR="#000080"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">1</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">;</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT>

<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#008000"><I>//</I></FONT><FONT COLOR="#008000"> </FONT><FONT COLOR="#008000"><I>Response Message</I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">message MyResponse</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">required int32 Length = </SPAN></SPAN></FONT></FONT><FONT COLOR="#000080"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">1</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">;</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT></PRE><P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>The
	'proto' file is then compiled to C# and Java source code. Declared
	messages are transformed to classes containing declared fields and
	serialization functionality.</FONT></FONT></FONT></P>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3>The
	following commands were used in our example to compile the 'proto'
	file:</FONT></FONT></FONT></P>
	<DIV ID="premain245198" DIR="LTR" STYLE="background: #fbedbb">
		<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; widows: 2; orphans: 2"><A NAME="copycode245198"></A>
		<BR>
		</P>
	</DIV>
	<PRE CLASS="western" STYLE="margin-bottom: 0.08in; background: #fbedbb; border: 1px solid #fbedbb; padding: 0.06in; font-style: normal; font-weight: normal; widows: 2; orphans: 2"><A NAME="pre245198"></A><FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">protogen.exe -i:MessageDeclarations.proto -o:MessageDeclarations.cs</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">protoc.exe -I=./ --java_out=./ ./MessageDeclarations.proto</FONT></FONT></FONT></PRE><H3 CLASS="western" STYLE="margin-top: 0in; margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 14pt">Android
	Client Application</FONT></FONT></FONT></H3>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">The
	Android client is a very simple application allowing user to put
	some text message and send the request to the service to get back
	the length of the text.<BR>When the response message is received it
	must be marshaled to the UI thread to display the result.<BR><BR>The
	client uses&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">EneterProtoBufSerializer</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.
	It instantiates the serializer in the&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">openConnection()</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;method
	and puts its reference to the&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">DuplexTypedMessagesFactory</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;ensuring
	so the message sender will use Protocol Buffers.<BR><BR>The whole
	implementation is very simple:</SPAN></SPAN></FONT></FONT></FONT></P>
	<DIV ID="premain147567" DIR="LTR" STYLE="background: #fbedbb">
		<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; widows: 2; orphans: 2">
		<FONT COLOR="#999999">Java</FONT></P>
		<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; widows: 2; orphans: 2"><A NAME="preShrink147567"></A><A NAME="copycode147567"></A>
		<FONT COLOR="#999999"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">Shrink
		&#9650;&nbsp;&nbsp;&nbsp;</FONT></FONT></FONT></P>
	</DIV>
	<PRE CLASS="western" STYLE="background: #fbedbb; border: none; padding: 0in; font-style: normal; font-weight: normal; widows: 2; orphans: 2"><A NAME="pre147567"></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><FONT COLOR="#0000ff">package</FONT> net.client;</FONT></FONT></FONT>

<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> message.declarations.MessageDeclarations.*;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> eneter.messaging.dataprocessing.serializing.ISerializer;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> eneter.messaging.diagnostic.EneterTrace;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> eneter.messaging.endpoints.typedmessages.*;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> eneter.messaging.messagingsystems.messagingsystembase.*;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> eneter.messaging.messagingsystems.tcpmessagingsystem.TcpMessagingSystemFactory;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> eneter.net.system.EventHandler;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> eneter.protobuf.ProtoBufSerializer;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> android.app.Activity;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> android.os.Bundle;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> android.os.Handler;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> android.view.View;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> android.view.View.OnClickListener;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">import</FONT> android.widget.*;</FONT></FONT></FONT>

<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">public</FONT> <FONT COLOR="#0000ff">class</FONT> AndroidNetCommunicationClientActivity <FONT COLOR="#0000ff">extends</FONT> Activity</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">UI controls</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Handler myRefresh = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Handler();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> EditText myMessageTextEditText;</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> EditText myResponseEditText;</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Button mySendRequestBtn;</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Sender sending MyRequest and as a response receiving MyResponse.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> IDuplexTypedMessageSender&lt;MyResponse, MyRequest&gt; mySender;</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">/** Called when the activity is first created. */</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#339999"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">@Override</SPAN></SPAN></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">public</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> onCreate(Bundle savedInstanceState)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">super</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.onCreate(savedInstanceState);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">setContentView(R.layout.main);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Get UI widgets.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myMessageTextEditText = (EditText) findViewById(R.id.messageTextEditText);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myResponseEditText = (EditText) findViewById(R.id.messageLengthEditText);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">mySendRequestBtn = (Button) findViewById(R.id.sendRequestBtn);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Subscribe to handle the button click.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">mySendRequestBtn.setOnClickListener(myOnSendRequestClickHandler);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Open the connection in another thread.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Note: From Android 3.1 (Honeycomb) or higher</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">       </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">it is not possible to open TCP connection</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">       </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">from the main thread.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Thread anOpenConnectionThread = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Thread(</SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Runnable()</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT COLOR="#339999"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">@Override</SPAN></SPAN></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">public</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> run()</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">try</SPAN></SPAN></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">                    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">openConnection();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">catch</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> (Exception err)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">EneterTrace.error(</SPAN></SPAN></FONT></FONT><FONT COLOR="#800080"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&quot;Open connection failed.&quot;</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">, err);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">});</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">anOpenConnectionThread.start();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    <FONT COLOR="#339999"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">@Override</SPAN></SPAN></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">public</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> onDestroy()</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Stop listening to response messages.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">mySender.detachDuplexOutputChannel();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">super</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.onDestroy();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">} </SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> openConnection() </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">throws</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Exception</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Instantiate Protocol Buffer based serializer.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">ISerializer aSerializer = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> ProtoBufSerializer();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Create sender sending MyRequest and as a response receiving MyResponse</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">The sender will use Protocol Buffers to serialize/deserialize messages. </SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">IDuplexTypedMessagesFactory aSenderFactory = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> DuplexTypedMessagesFactory(aSerializer);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">mySender = aSenderFactory.createDuplexTypedMessageSender(MyResponse.</SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">class</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">, MyRequest.</SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">class</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Subscribe to receive response messages.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">mySender.responseReceived().subscribe(myOnResponseHandler);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Create TCP messaging for the communication.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Note: 10.0.2.2 is a special alias to the loopback (127.0.0.1)</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">       </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">on the development machine.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">IMessagingSystemFactory aMessaging = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> TcpMessagingSystemFactory();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">IDuplexOutputChannel anOutputChannel</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">= aMessaging.createDuplexOutputChannel(</SPAN></SPAN></FONT></FONT><FONT COLOR="#800080"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&quot;tcp://10.0.2.2:8060/&quot;</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//= aMessaging.createDuplexOutputChannel(&quot;tcp://192.168.1.102:8060/&quot;);</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Attach the output channel to the sender and be able to send</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">messages and receive responses.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">mySender.attachDuplexOutputChannel(anOutputChannel);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> onSendRequest(View v)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Create the request message using ProtoBuf builder pattern.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">final</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> MyRequest aRequestMsg = MyRequest.newBuilder()</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.setText(myMessageTextEditText.getText().toString())</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.build();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Send the request message.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">try</SPAN></SPAN></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">mySender.sendRequestMessage(aRequestMsg);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">catch</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> (Exception err)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">EneterTrace.error(</SPAN></SPAN></FONT></FONT><FONT COLOR="#800080"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&quot;Sending the message failed.&quot;</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">, err);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        </FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> onResponseReceived(Object sender,</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                                    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">final</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> TypedResponseReceivedEventArgs&lt;MyResponse&gt; e)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Display the result - returned number of characters.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Note: Marshal displaying to the correct UI thread.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myRefresh.post(</SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Runnable()</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT COLOR="#339999"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">@Override</SPAN></SPAN></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">public</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> run()</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myResponseEditText.setText(Integer.toString(e.getResponseMessage().getLength()));</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">});</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> EventHandler&lt;TypedResponseReceivedEventArgs&lt;MyResponse&gt;&gt; myOnResponseHandler</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">= </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> EventHandler&lt;TypedResponseReceivedEventArgs&lt;MyResponse&gt;&gt;()</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#339999"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">@Override</SPAN></SPAN></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">public</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> onEvent(Object sender,</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">TypedResponseReceivedEventArgs&lt;MyResponse&gt; e)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">onResponseReceived(sender, e);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">};</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    </FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> OnClickListener myOnSendRequestClickHandler = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> OnClickListener()</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#339999"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">@Override</SPAN></SPAN></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">public</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> onClick(View v)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">onSendRequest(v);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">};</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT></PRE><H3 CLASS="western" STYLE="margin-top: 0in; margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#ff9900"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 14pt">.NET
	Service Application</FONT></FONT></FONT></H3>
	<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
	<FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">The
	.NET service is a simple console application listening to TCP and
	receiving requests to calculate the length of a given text.<BR><BR>The
	service uses&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">EneterProtoBufSerializer</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">.
	It instantiates the serializer and puts its reference to
	the&nbsp;</SPAN></SPAN></FONT></FONT></FONT><CODE CLASS="western"><FONT COLOR="#990000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=3 STYLE="font-size: 11pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">DuplexTypedMessagesFactory</SPAN></SPAN></FONT></FONT></FONT></CODE><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&nbsp;ensuring
	so the message receiver will use Protocol Buffers to deserialize
	incoming messages and serialize response messages.<BR><BR>The whole
	implementation is very simple:</SPAN></SPAN></FONT></FONT></FONT></P>
	<DIV ID="premain404995" DIR="LTR" STYLE="background: #fbedbb">
		<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; widows: 2; orphans: 2">
		<FONT COLOR="#999999">C#</FONT></P>
		<P CLASS="western" STYLE="margin-bottom: 0in; border: none; padding: 0in; font-style: normal; font-weight: normal; widows: 2; orphans: 2"><A NAME="preShrink404995"></A><A NAME="copycode404995"></A>
		<FONT COLOR="#999999"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 9pt">Shrink
		&#9650;&nbsp;&nbsp;&nbsp;</FONT></FONT></FONT></P>
	</DIV>
	<PRE CLASS="western" STYLE="background: #fbedbb; border: none; padding: 0in; font-style: normal; font-weight: normal; widows: 2; orphans: 2"><A NAME="pre404995"></A><FONT COLOR="#111111"><FONT FACE="Segoe UI, Arial, sans-serif"><FONT SIZE=3><FONT COLOR="#0000ff">using</FONT> System;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">using</FONT> Eneter.Messaging.DataProcessing.Serializing;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">using</FONT> Eneter.Messaging.EndPoints.TypedMessages;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">using</FONT> Eneter.Messaging.MessagingSystems.MessagingSystemBase;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">using</FONT> Eneter.Messaging.MessagingSystems.TcpMessagingSystem;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">using</FONT> Eneter.ProtoBuf;</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">using</FONT> message.declarations;</FONT></FONT></FONT>

<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><FONT COLOR="#0000ff">namespace</FONT> ServiceExample</FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">{</FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">class</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Program</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">static</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> IDuplexTypedMessageReceiver&lt;MyResponse, MyRequest&gt; myReceiver;</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">static</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> Main(string[] args)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Instantiate Protocol Buffer based serializer.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">ISerializer aSerializer = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> ProtoBufSerializer();</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Create message receiver receiving 'MyRequest' and receiving 'MyResponse'.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">The receiver will use Protocol Buffers to serialize/deserialize messages. </SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">IDuplexTypedMessagesFactory aReceiverFactory =</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> DuplexTypedMessagesFactory(aSerializer);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myReceiver = aReceiverFactory.CreateDuplexTypedMessageReceiver&lt;MyResponse, MyRequest&gt;();</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Subscribe to handle messages.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myReceiver.MessageReceived += OnMessageReceived;</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Create TCP messaging.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">IMessagingSystemFactory aMessaging = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> TcpMessagingSystemFactory();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            </FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">IDuplexInputChannel anInputChannel</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">= aMessaging.CreateDuplexInputChannel(</SPAN></SPAN></FONT></FONT><FONT COLOR="#800080"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&quot;tcp://127.0.0.1:8060/&quot;</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">);</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Attach the input channel and start to listen to messages.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myReceiver.AttachDuplexInputChannel(anInputChannel);</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Console.WriteLine(</SPAN></SPAN></FONT></FONT><FONT COLOR="#800080"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&quot;The service is running. To stop press enter.&quot;</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Console.ReadLine();</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Detach the input channel and stop listening.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">It releases the thread listening to messages.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myReceiver.DetachDuplexInputChannel();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">        <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">It is called when a message is received.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">private</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">static</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">void</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> OnMessageReceived(</SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">object</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> sender,</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">                                              <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">TypedRequestReceivedEventArgs&lt;MyRequest&gt; e)</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">{</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">Console.WriteLine(</SPAN></SPAN></FONT></FONT><FONT COLOR="#800080"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">&quot;Received: &quot;</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> + e.RequestMessage.Text);</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Create the response message.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">MyResponse aResponse = </SPAN></SPAN></FONT></FONT><FONT COLOR="#0000ff"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">new</SPAN></SPAN></FONT></FONT></FONT><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> MyResponse();</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">aResponse.Length = e.RequestMessage.Text.Length;</SPAN></SPAN></FONT></FONT></FONT>

<FONT COLOR="#000000">            <FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">//</SPAN></I></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal"> </SPAN></SPAN></FONT></FONT></FONT><FONT COLOR="#008000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><I><SPAN STYLE="font-weight: normal">Send the response message back to the client.</SPAN></I></FONT></FONT></FONT></FONT>
<FONT COLOR="#000000">            <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">myReceiver.SendResponseMessage(e.ResponseReceiverId, aResponse);</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">        <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000">    <FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt"><SPAN STYLE="font-style: normal"><SPAN STYLE="font-weight: normal">}</SPAN></SPAN></FONT></FONT></FONT>
<FONT COLOR="#000000"><FONT FACE="Consolas, monospace, mono"><FONT SIZE=2 STYLE="font-size: 10pt">}</FONT></FONT></FONT></PRE>
</DIV>
<H2 CLASS="western" STYLE="margin-top: 0.21in; margin-bottom: 0.11in; border: none; padding: 0in; line-height: 140%; widows: 2; orphans: 2">
<BR><BR>
</H2>
</BODY>
</HTML>